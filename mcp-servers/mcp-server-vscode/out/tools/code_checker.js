import { DiagnosticSeverity, languages } from 'vscode';
export const codeCheckerTool = (severityLevel = DiagnosticSeverity.Warning) => {
    const diagnosticsByFile = languages.getDiagnostics();
    const aggregated = diagnosticsByFile
        .filter(([_uri, diags]) => diags.some((diag) => diag.severity <= severityLevel))
        .map(([uri, diags]) => ({
        file: uri.fsPath,
        diagnostics: diags
            .filter((diag) => diag.severity <= severityLevel)
            .map((diag) => ({
            severity: DiagnosticSeverity[diag.severity],
            message: diag.message,
            source: diag.source || '',
        })),
    }));
    if (aggregated.length === 0) {
        return { content: [{ type: 'text', text: 'No issues found.' }], isError: false };
    }
    return { content: [{ type: 'text', text: JSON.stringify(aggregated, null, 2) }], isError: false };
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29kZV9jaGVja2VyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3Rvb2xzL2NvZGVfY2hlY2tlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsU0FBUyxFQUFFLE1BQU0sUUFBUSxDQUFDO0FBT3ZELE1BQU0sQ0FBQyxNQUFNLGVBQWUsR0FBRyxDQUFDLGdCQUFvQyxrQkFBa0IsQ0FBQyxPQUFPLEVBQUUsRUFBRTtJQUU5RixNQUFNLGlCQUFpQixHQUFHLFNBQVMsQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUdyRCxNQUFNLFVBQVUsR0FBRyxpQkFBaUI7U0FDL0IsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxRQUFRLElBQUksYUFBYSxDQUFDLENBQUM7U0FDL0UsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDcEIsSUFBSSxFQUFFLEdBQUcsQ0FBQyxNQUFNO1FBQ2hCLFdBQVcsRUFBRSxLQUFLO2FBQ2IsTUFBTSxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsUUFBUSxJQUFJLGFBQWEsQ0FBQzthQUNoRCxHQUFHLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDWixRQUFRLEVBQUUsa0JBQWtCLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQztZQUMzQyxPQUFPLEVBQUUsSUFBSSxDQUFDLE9BQU87WUFDckIsTUFBTSxFQUFFLElBQUksQ0FBQyxNQUFNLElBQUksRUFBRTtTQUM1QixDQUFDLENBQUM7S0FDVixDQUFDLENBQUMsQ0FBQztJQUVSLElBQUksVUFBVSxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUUsQ0FBQztRQUUxQixPQUFPLEVBQUUsT0FBTyxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxrQkFBa0IsRUFBRSxDQUFDLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxDQUFDO0lBQ3JGLENBQUM7SUFHRCxPQUFPLEVBQUUsT0FBTyxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsQ0FBQztBQUN0RyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEaWFnbm9zdGljU2V2ZXJpdHksIGxhbmd1YWdlcyB9IGZyb20gJ3ZzY29kZSc7XG5cbi8qKlxuICogUmV0cmlldmUgZGlhZ25vc3RpY3MgZm9yIHRoZSBhY3RpdmUgd29ya3NwYWNlLCB3aXRoIGZpbHRlcmluZyBieSBzZXZlcml0eSBsZXZlbC5cbiAqXG4gKiBAcGFyYW0gJ1dhcm5pbmcnIC0gTWluaW11bSBzZXZlcml0eSBsZXZlbCB0byBpbmNsdWRlIChkZWZhdWx0IGlzIFdhcm5pbmcpLlxuICovXG5leHBvcnQgY29uc3QgY29kZUNoZWNrZXJUb29sID0gKHNldmVyaXR5TGV2ZWw6IERpYWdub3N0aWNTZXZlcml0eSA9IERpYWdub3N0aWNTZXZlcml0eS5XYXJuaW5nKSA9PiB7XG4gICAgLy8gUmV0cmlldmUgZGlhZ25vc3RpY3MgZnJvbSBhbGwgZmlsZXNcbiAgICBjb25zdCBkaWFnbm9zdGljc0J5RmlsZSA9IGxhbmd1YWdlcy5nZXREaWFnbm9zdGljcygpO1xuXG4gICAgLy8gRmlsdGVyIGRpYWdub3N0aWNzIGJhc2VkIG9uIHRoZSB0YXJnZXQgc2V2ZXJpdHlcbiAgICBjb25zdCBhZ2dyZWdhdGVkID0gZGlhZ25vc3RpY3NCeUZpbGVcbiAgICAgICAgLmZpbHRlcigoW191cmksIGRpYWdzXSkgPT4gZGlhZ3Muc29tZSgoZGlhZykgPT4gZGlhZy5zZXZlcml0eSA8PSBzZXZlcml0eUxldmVsKSlcbiAgICAgICAgLm1hcCgoW3VyaSwgZGlhZ3NdKSA9PiAoe1xuICAgICAgICAgICAgZmlsZTogdXJpLmZzUGF0aCxcbiAgICAgICAgICAgIGRpYWdub3N0aWNzOiBkaWFnc1xuICAgICAgICAgICAgICAgIC5maWx0ZXIoKGRpYWcpID0+IGRpYWcuc2V2ZXJpdHkgPD0gc2V2ZXJpdHlMZXZlbClcbiAgICAgICAgICAgICAgICAubWFwKChkaWFnKSA9PiAoe1xuICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogRGlhZ25vc3RpY1NldmVyaXR5W2RpYWcuc2V2ZXJpdHldLFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBkaWFnLm1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZTogZGlhZy5zb3VyY2UgfHwgJycsXG4gICAgICAgICAgICAgICAgfSkpLFxuICAgICAgICB9KSk7XG5cbiAgICBpZiAoYWdncmVnYXRlZC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgLy8gSWYgbm8gZGlhZ25vc3RpY3MgZm91bmQsIHJldHVybiBhbiBlbXB0eSByZXN1bHRcbiAgICAgICAgcmV0dXJuIHsgY29udGVudDogW3sgdHlwZTogJ3RleHQnLCB0ZXh0OiAnTm8gaXNzdWVzIGZvdW5kLicgfV0sIGlzRXJyb3I6IGZhbHNlIH07XG4gICAgfVxuXG4gICAgLy8gT3RoZXJ3aXNlLCByZXR1cm4gdGhlIGFnZ3JlZ2F0ZWQgZGlhZ25vc3RpY3MgYXMgZm9ybWF0dGVkIEpTT05cbiAgICByZXR1cm4geyBjb250ZW50OiBbeyB0eXBlOiAndGV4dCcsIHRleHQ6IEpTT04uc3RyaW5naWZ5KGFnZ3JlZ2F0ZWQsIG51bGwsIDIpIH1dLCBpc0Vycm9yOiBmYWxzZSB9O1xufTtcbiJdfQ==